p_build$group1 = with(p_build,interaction(factor(group), factor(fill_group)))
p_build$algorithm = p_build$PANEL %>%
recode('1' = levels(dat$algorithm)[1],
'2' = levels(dat$algorithm)[2],
'3' = levels(dat$algorithm)[3])
#Note the use of the group aesthetic here with our computed version,
# group1
p_fill = ggplot() +
geom_hline(yintercept = 0, col = "darkgrey", size = 0.5) +
geom_polygon(data = p_build,
aes(x = x, y = y, group = group1, fill = fill_group),
alpha = 0.8, col = "black") +
scale_fill_brewer(palette = "Dark2") +
scale_color_brewer(palette = "Dark2") +
scale_x_continuous(breaks = 1:length(levels(dat$feature.set)),
labels = levels(dat$feature.set)) +
labs(x = "", y = bquote(Delta*"RMSE (Model-based error reduction)"),
fill = "Better prediction by: ") +
facet_grid(algorithm ~ .) +
theme_bw() +
theme(legend.position = "top",
strip.background = element_rect(colour="black", fill="white"),
strip.text = element_text(face = "bold", size = 15))
return(p_fill)
}
## Plot results
plot_fit_results(fit_stats)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformance_RMSE.png"),
device = "png", width = 6, height = 8, dpi = 300, bg = "transparent")
plot_fit_results(fit_stats_som)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformanceSom_RMSE.png"),
device = "png", width = 6, height = 8, dpi = 300, bg = "transparent")
## Transform variable importance data to long data.frame
var_imp = omicsplusclin.output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>%
group_by(algorithm) %>%
pivot_longer(VEGF.A_LS:sex_male, names_to = "variable", values_to = "importance") %>%
#mutate(importance = rescale(importance, to = c(0, 100))) %>%
group_by(algorithm, variable) %>%
summarise(mean = mean(importance),
sd = sd(importance),
ci.lb = quantile(importance, probs = 0.025),
ci.ub = quantile(importance, probs = 0.975),
median = median(importance),
iqr.lb = quantile(importance, probs = 0.25),
iqr.ub = quantile(importance, probs = 0.75)) %>%
group_by(algorithm) %>%
arrange(algorithm, desc(median)) %>%
slice_head(n = 20) %>%
mutate(variable = factor(variable, levels = rev(unique(variable))))
var_imp$algorithm = algorithm = recode(var_imp$algorithm,
'rf' = "Random forest",
'glmnet' = "Elastic net",
'knn' = "k-Nearest neighbour") %>%
factor(levels = c("Elastic net", "Random forest", "k-Nearest neighbour"))
var_imp$variable_group = ifelse(var_imp$variable %in% clin.vars, "Clinical",
ifelse(var_imp$variable %in% cyto_ref$vars, "Cytokines",
ifelse(var_imp$variable %in% rna.vars, "Gene expression",
"PRS")))
ggplot(var_imp, aes(x = variable, y = median)) +
geom_errorbar(aes(ymin = iqr.lb, ymax = iqr.ub, group = algorithm), position = position_dodge(0.5)) +
geom_point(aes(fill = variable_group), shape = 21, position = position_dodge(0.5), size = 3) +
labs(x = "", y = "Variable Importance: Median (IQR)") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
facet_wrap(algorithm~., scales = "free") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
strip.background = element_rect(colour="black", fill="white"),
strip.text = element_text(face = "bold", size = 15))
unique(var_imp$algorithm)
unique(var_imp$algorithm)[1]
head(var_imp)
library("ggpubr")
ggplot(var_imp, aes(x = variable, y = median)) +
geom_errorbar(aes(ymin = iqr.lb, ymax = iqr.ub, group = algorithm), position = position_dodge(0.5)) +
geom_point(aes(fill = variable_group), shape = 21, position = position_dodge(0.5), size = 3) +
labs(x = "", y = "Variable Importance: Median (IQR)") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
facet_wrap(algorithm~., scales = "free") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
strip.background = element_rect(colour="black", fill="white"),
strip.text = element_text(face = "bold", size = 15))
ggplot(var_imp, aes(x = variable, y = median)) +
geom_errorbar(aes(ymin = iqr.lb, ymax = iqr.ub)) +
geom_point(aes(fill = variable_group), shape = 21,  size = 3) +
labs(x = "", y = "Variable Importance: Median (IQR)") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
facet_wrap(algorithm~., scales = "free") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
strip.background = element_rect(colour="black", fill="white"),
strip.text = element_text(face = "bold", size = 15))
length(varImp_plots)
varImp_plots = list()
length(varImp_plots)
varImp_plots = list()
for(i in unique(var_imp$algorithm))   {
temp_var_imp = temp_var_imp %>%
filter(algorithm == i) %>%
arrange(desc(median)) %>%
mutate(variable = factor(variable, levels = rev(unique(variable))))
varImp_plot = ggplot(temp_var_imp, aes(x = variable, y = median)) +
geom_errorbar(aes(ymin = iqr.lb, ymax = iqr.ub)) +
geom_point(aes(fill = variable_group), shape = 21, size = 3) +
labs(x = "", y = "Variable Importance: Median (IQR)") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
facet_wrap(algorithm~., scales = "free") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
strip.background = element_rect(colour="black", fill="white"),
strip.text = element_text(face = "bold", size = 15))
varImp_plots[[length(varImp_plots) + 1]] = varImp_plot
}
varImp_plots = list()
for(i in unique(var_imp$algorithm))   {
temp_var_imp = var_imp %>%
filter(algorithm == i) %>%
arrange(desc(median)) %>%
mutate(variable = factor(variable, levels = rev(unique(variable))))
varImp_plot = ggplot(temp_var_imp, aes(x = variable, y = median)) +
geom_errorbar(aes(ymin = iqr.lb, ymax = iqr.ub)) +
geom_point(aes(fill = variable_group), shape = 21, size = 3) +
labs(x = "", y = "Variable Importance: Median (IQR)") +
scale_fill_brewer(palette = "Dark2") +
coord_flip() +
facet_wrap(algorithm~., scales = "free") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
strip.background = element_rect(colour="black", fill="white"),
strip.text = element_text(face = "bold", size = 15))
varImp_plots[[length(varImp_plots) + 1]] = varImp_plot
}
combined_plot = ggarrange(plotlist = varImp_plots, ncol = 2, nrow = 1, common.legend = TRUE)
combined_plot
.libPaths("C:/Users/nkapp/R")
.libPaths("C:/Users/nkapp/R")
## Load packages
library("tidyverse")
library("table1")
library("tableone")
library("ggcorrplot")
library("RColorBrewer")
install.packages("tableone")
?tableone::CreateTableOne
library("tableone")
## Load data
load("./Data/OPTIMA_Cytokine_PreprocessedData.RData")
## Load ML model output
load("./Results/clinical.output.RData")
load("./Results/cytokine.output.RData")
load("./Results/rna.output.RData")
load("./Results/prs.output.RData")
load("./Results/omics.output.RData")
load("./Results/omicsplusclin.output.RData")
load("./Results/clinical.output.som.RData")
load("./Results/cytokine.output.som.RData")
load("./Results/rna.output.som.RData")
load("./Results/prs.output.som.RData")
load("./Results/omics.output.som.RData")
load("./Results/omicsplusclin.output.som.RData")
## Index participants used in analysis
# Index participants with minimum of two BDI observations
ids_with_bdi = dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums < 7
# Index participants with genetic data
ids_with_geneticdata = !is.na(dat$BMI_PRS)
# Index participants with transcriptomic data
ids_with_rnadata = !is.na(dat$rna.PC1) # Present in all individuals
# Index participants with all relevant data
ids_for_analysis = ids_with_bdi & ids_with_geneticdata & ids_with_rnadata
## Load cytokine reference
load("./Data/Cytokine_Reference.RData")
## Define vars
prs.vars = colnames(dat)[grepl("PRS", colnames(dat))]
rna.vars = colnames(dat)[grepl("rna.PC", colnames(dat))]
clin.vars = c("t0_madrs", "sex", "age", "BMI", "t0_diagn_by_age",
paste0("t0_cidi_", c("depression_episode", "depression_recurrent",
"anxiety", "substance")),
paste0("t0_pid_", c("negaff", "detach", "psycho", "antago", "disinh")),
paste0("t0_bsi_", c("soma", "zwan", "unsi", "depr", "angs", "aggr",
"phob", "para", "psyc")))
## Source nested cross-validation function
source("./Scripts/functions.R")
## Fit statistics are combined
fit_stats = collate_fit_results(list(
clinical.output$fit, cytokine.output$fit, prs.output$fit,
rna.output$fit, omics.output$fit, omicsplusclin.output$fit
))
# A results table is created
fit_stats_table = get_fit_results_table(fit_stats)
write_csv(fit_stats_table, file = "./Results/Fit_Stats_Table.csv")
fit_stats_table
fit_stats_som = collate_fit_results(list(
clinical.output.som$fit, cytokine.output.som$fit, prs.output.som$fit,
rna.output.som$fit, omics.output.som$fit, omicsplusclin.output.som$fit
))
# A results table is created
fit_stats_som_table = get_fit_results_table(fit_stats_som)
write_csv(fit_stats_som_table, file = "./Results/Fit_Stats_Som_Table.csv")
## Plot results
plot_fit_results(fit_stats)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformance_RMSE.png"),
device = "png", width = 8, height = 8, dpi = 300, bg = "transparent")
plot_fit_results(fit_stats_som)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformanceSom_RMSE.png"),
device = "png", width = 8, height = 8, dpi = 300, bg = "transparent")
plot_variable_importance(omicsplusclin.output)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_VarImp.png"),
device = "png", width = 6, height = 6, dpi = 300, bg = "transparent")
plot_variable_importance(omicsplusclin.output.som)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_VarImp_Som.png"),
device = "png", width = 6, height = 6, dpi = 300, bg = "transparent")
?vip::vip
?vip::vi
?vip::vi_model
library("vip")
sessionInfo()
citation("vip")
by(dat$bdi_locf_improve, ids_for_analysis, summary)
by(dat$bdi_locf_improve, ids_for_analysis, describe)
by(dat$bdi_locf_improve, ids_for_analysis, sd)
table(ids_with_geneticdata)
table(ids_with_bdi, ids_with_geneticdata)
with(dat[ids_for_analysis], summary(bdi_locf_improve / sd(bdi_locf_improve)))
# Overall
by(dat$bdi_locf_improve, ids_for_analysis, summary)
by(dat$bdi_locf_improve, ids_for_analysis, sd)
# SMD
with(dat[ids_for_analysis], summary(bdi_locf_improve / sd(bdi_locf_improve)))
# SMD
with(dat[ids_for_analysis], sd(bdi_locf_improve / sd(bdi_locf_improve)))
# Overall
by(dat$bdi_som_locf_improve, ids_for_analysis, summary)
by(dat$bdi_som_locf_improve, ids_for_analysis, sd)
# SMD
with(dat[ids_for_analysis], summary(bdi_som_locf_improve / sd(bdi_locf_improve)))
ml_output = omicsplusclin.output
var_imp = ml_output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>%
group_by(algorithm) %>%
pivot_longer(VEGF.A_LS:sex_male, names_to = "variable", values_to = "importance") %>%
group_by(algorithm, variable) %>%
summarise(mean = mean(importance),
sd = sd(importance),
ci.lb = quantile(importance, probs = 0.025),
ci.ub = quantile(importance, probs = 0.975),
median = median(importance),
iqr.lb = quantile(importance, probs = 0.25),
iqr.ub = quantile(importance, probs = 0.75)) %>%
group_by(algorithm) %>%
arrange(algorithm, desc(median)) %>%
slice_head(n = top_n_predictors) %>%
arrange(algorithm, median) %>%
ungroup() %>%
mutate(order = row_number())
var_imp$algorithm = algorithm = recode(var_imp$algorithm,
'rf' = "Random forest",
'glmnet' = "Elastic net",
'knn' = "k-Nearest neighbour") %>%
factor(levels = c("Elastic net", "Random forest", "k-Nearest neighbour")) %>%
droplevels()
top_n_predictors = 20
var_imp = ml_output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>%
group_by(algorithm) %>%
pivot_longer(VEGF.A_LS:sex_male, names_to = "variable", values_to = "importance") %>%
group_by(algorithm, variable) %>%
summarise(mean = mean(importance),
sd = sd(importance),
ci.lb = quantile(importance, probs = 0.025),
ci.ub = quantile(importance, probs = 0.975),
median = median(importance),
iqr.lb = quantile(importance, probs = 0.25),
iqr.ub = quantile(importance, probs = 0.75)) %>%
group_by(algorithm) %>%
arrange(algorithm, desc(median)) %>%
slice_head(n = top_n_predictors) %>%
arrange(algorithm, median) %>%
ungroup() %>%
mutate(order = row_number())
var_imp$algorithm = algorithm = recode(var_imp$algorithm,
'rf' = "Random forest",
'glmnet' = "Elastic net",
'knn' = "k-Nearest neighbour") %>%
factor(levels = c("Elastic net", "Random forest", "k-Nearest neighbour")) %>%
droplevels()
var_imp$variable_group = ifelse(var_imp$variable %in% clin.vars, "Clinical",
ifelse(var_imp$variable %in% cyto_ref$vars, "Cytokines",
ifelse(var_imp$variable %in% rna.vars, "Gene expression",
"PRS")))
ml_output$importance
colnames(ml_output$importance)
?pivot_longer
ml_output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>% colnames()
ml_output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>%
group_by(algorithm) %>%
pivot_longer(!contains("algorithm"), names_to = "variable", values_to = "importance")
ml_output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>%
group_by(algorithm) %>%
pivot_longer(!contains("algorithm"), names_to = "variable", values_to = "importance") %>% pull(variable) %>% unique()
plot_variable_importance = function(
ml_output, # output from ml_pipeline function
top_n_predictors = 20, # number of top predictors to be plotted
precision_type = "IQR" # Alternative: CI
)  {
var_imp = ml_output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>%
group_by(algorithm) %>%
pivot_longer(!contains("algorithm"), names_to = "variable", values_to = "importance") %>%
group_by(algorithm, variable) %>%
summarise(mean = mean(importance),
sd = sd(importance),
ci.lb = quantile(importance, probs = 0.025),
ci.ub = quantile(importance, probs = 0.975),
median = median(importance),
iqr.lb = quantile(importance, probs = 0.25),
iqr.ub = quantile(importance, probs = 0.75)) %>%
group_by(algorithm) %>%
arrange(algorithm, desc(median)) %>%
slice_head(n = top_n_predictors) %>%
arrange(algorithm, median) %>%
ungroup() %>%
mutate(order = row_number())
var_imp$algorithm = algorithm = recode(var_imp$algorithm,
'rf' = "Random forest",
'glmnet' = "Elastic net",
'knn' = "k-Nearest neighbour") %>%
factor(levels = c("Elastic net", "Random forest", "k-Nearest neighbour")) %>%
droplevels()
var_imp$variable_group = ifelse(var_imp$variable %in% clin.vars, "Clinical",
ifelse(var_imp$variable %in% cyto_ref$vars, "Cytokines",
ifelse(var_imp$variable %in% rna.vars, "Gene expression",
"PRS")))
var_imp$variable = gsub("rna.", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("_PRS", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("t0_", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("VEGF.A", "VEGF-A", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("cidi", "CIDI", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub(".", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("alpha", "a", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("beta", "b", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("diagn_by_age", "Age-corrected\n#diagnoses", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("bsi", "BSI", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("depr", "Depression", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("Depressionession_episode", "depressive\nepisode", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("Depressionession_recurrent", "recurrent\ndepression", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("unsi", "Interper-\nsonal Sensitivity", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("angs", "Anxiety", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("phob", "Phobic\nAnxiety", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("pid", "PID", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("antago", "Antagonism", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("disinh", "Disinhibition", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("_", " ", var_imp$variable, fixed = TRUE)
if(precision_type == "IQR")   {
var_imp$lb = var_imp$iqr.lb
var_imp$ub = var_imp$iqr.ub
} else if(precision_type == "CI")   {
var_imp$lb = var_imp$ci.lb
var_imp$ub = var_imp$ci.ub
} else   {stop("Please set precision_type to 'IQR' or 'CI'.")}
varImp_plot = ggplot(var_imp, aes(x = order, y = median)) +
geom_errorbar(aes(ymin = lb, ymax = ub)) +
geom_point(aes(fill = variable_group), shape = 21, size = 3) +
labs(x = "", y = paste0("Variable Importance: Median (",
ifelse(precision_type == "IQR", "IQR", "95% CI"), ")")) +
scale_fill_brewer(palette = "Set2") +
facet_wrap(algorithm~., scales = "free") +
scale_x_continuous(breaks = var_imp$order,
labels = var_imp$variable,
expand = c(0, 0)) +
coord_flip() +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
strip.background = element_rect(colour="black", fill="white"),
strip.text = element_text(face = "bold", size = 15))
return(varImp_plot)
}
plot_variable_importance(omicsplusclin.output)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_VarImp.png"),
device = "png", width = 6, height = 6, dpi = 300, bg = "transparent")
plot_variable_importance(omicsplusclin.output.som)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_VarImp_Som.png"),
device = "png", width = 6, height = 6, dpi = 300, bg = "transparent")
ml_output = omicsplusclin.output
var_imp = ml_output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>%
group_by(algorithm) %>%
pivot_longer(!contains("algorithm"), names_to = "variable", values_to = "importance") %>%
group_by(algorithm, variable) %>%
summarise(mean = mean(importance),
sd = sd(importance),
ci.lb = quantile(importance, probs = 0.025),
ci.ub = quantile(importance, probs = 0.975),
median = median(importance),
iqr.lb = quantile(importance, probs = 0.25),
iqr.ub = quantile(importance, probs = 0.75)) %>%
group_by(algorithm) %>%
arrange(algorithm, desc(median)) %>%
slice_head(n = top_n_predictors) %>%
arrange(algorithm, median) %>%
ungroup() %>%
mutate(order = row_number())
var_imp$algorithm = algorithm = recode(var_imp$algorithm,
'rf' = "Random forest",
'glmnet' = "Elastic net",
'knn' = "k-Nearest neighbour") %>%
factor(levels = c("Elastic net", "Random forest", "k-Nearest neighbour")) %>%
droplevels()
var_imp$variable_group = ifelse(var_imp$variable %in% clin.vars, "Clinical",
ifelse(var_imp$variable %in% cyto_ref$vars, "Cytokines",
ifelse(var_imp$variable %in% rna.vars, "Gene expression",
"PRS")))
var_imp$variable = gsub("rna.", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("_PRS", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("t0_", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("VEGF.A", "VEGF-A", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("cidi", "CIDI", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub(".", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("alpha", "a", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("beta", "b", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("diagn_by_age", "Age-corrected\n#diagnoses", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("bsi", "BSI", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("depr", "Depression", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("Depressionession_episode", "depressive\nepisode", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("Depressionession_recurrent", "recurrent\ndepression", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("unsi", "Interper-\nsonal Sensitivity", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("angs", "Anxiety", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("phob", "Phobic\nAnxiety", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("pid", "PID", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("antago", "Antagonism", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("disinh", "Disinhibition", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("_", " ", var_imp$variable, fixed = TRUE)
var_imp
var_imp$variable[duplicated(var_imp$variable)]
var_imp[duplicated(var_imp$variable), c("variable", "variable_group")]
ml_output = omicsplusclin.output.som
var_imp = ml_output$importance %>%
select(!c(sex, k)) %>%
filter(algorithm != "knn") %>%
group_by(algorithm) %>%
pivot_longer(!contains("algorithm"), names_to = "variable", values_to = "importance") %>%
group_by(algorithm, variable) %>%
summarise(mean = mean(importance),
sd = sd(importance),
ci.lb = quantile(importance, probs = 0.025),
ci.ub = quantile(importance, probs = 0.975),
median = median(importance),
iqr.lb = quantile(importance, probs = 0.25),
iqr.ub = quantile(importance, probs = 0.75)) %>%
group_by(algorithm) %>%
arrange(algorithm, desc(median)) %>%
slice_head(n = top_n_predictors) %>%
arrange(algorithm, median) %>%
ungroup() %>%
mutate(order = row_number())
var_imp$algorithm = algorithm = recode(var_imp$algorithm,
'rf' = "Random forest",
'glmnet' = "Elastic net",
'knn' = "k-Nearest neighbour") %>%
factor(levels = c("Elastic net", "Random forest", "k-Nearest neighbour")) %>%
droplevels()
var_imp$variable_group = ifelse(var_imp$variable %in% clin.vars, "Clinical",
ifelse(var_imp$variable %in% cyto_ref$vars, "Cytokines",
ifelse(var_imp$variable %in% rna.vars, "Gene expression",
"PRS")))
var_imp$variable = gsub("rna.", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("_PRS", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("t0_", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("VEGF.A", "VEGF-A", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("cidi", "CIDI", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub(".", "", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("alpha", "a", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("beta", "b", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("diagn_by_age", "Age-corrected\n#diagnoses", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("bsi", "BSI", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("depr", "Depression", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("Depressionession_episode", "depressive\nepisode", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("Depressionession_recurrent", "recurrent\ndepression", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("unsi", "Interper-\nsonal Sensitivity", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("angs", "Anxiety", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("phob", "Phobic\nAnxiety", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("pid", "PID", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("antago", "Antagonism", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("disinh", "Disinhibition", var_imp$variable, fixed = TRUE)
var_imp$variable = gsub("_", " ", var_imp$variable, fixed = TRUE)
var_imp[duplicated(var_imp$variable), c("variable", "variable_group")]
var_imp[duplicated(var_imp$variable), c("variable", "variable_group")] %>% arrange(variable_group)
1:10
1:20
1:30
1:40
