theme(legend.position = "top",
legend.title = element_blank(),
axis.ticks.x = element_text(angle = 0.45))
## Create barplot
ggplot(cyto_ref, aes(x = labels, y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
axis.ticks.x = element_text(angle = 0.45))
?theme
str(cyto_ref)
## Create barplot
ggplot(arrange(cyto_ref, perc),
aes(x = labels, y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = ) +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(angle = 0.45))
arrange(cyto_ref, perc)
## Create barplot
ggplot(cyto_ref, aes(x = labels, y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = ) +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(angle = 0.45))
## Create barplot
ggplot(cyto_ref, aes(x = labels, y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = "Complete Data (%)") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(angle = 0.45))
## Create barplot
ggplot(cyto_ref, aes(x = labels, y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = "Complete Data (%)") +
coord_flip() +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
## Create barplot
ggplot(cyto_ref, aes(x = labels, y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = "Complete Data (%)") +
coord_flip() +
theme_bw() +
theme(legend.position = "none",
legend.title = element_blank())
## Create barplot
ggplot(cyto_ref, aes(x = reorder(labels, -perc.complete), y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = "Complete Data (%)") +
coord_flip() +
theme_bw() +
theme(legend.position = "none",
legend.title = element_blank())
## Create barplot
ggplot(cyto_ref, aes(x = reorder(labels, perc.complete), y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = "Complete Data (%)") +
coord_flip() +
theme_bw() +
theme(legend.position = "none",
legend.title = element_blank())
## Create barplot
ggplot(cyto_ref, aes(x = reorder(labels, perc.complete, labels),
y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = "Complete Data (%)") +
coord_flip() +
theme_bw() +
theme(legend.position = "none",
legend.title = element_blank())
## Create barplot
ggplot(cyto_ref, aes(x = reorder(labels, perc.complete), y = perc.complete, fill = complete)) +
geom_bar(aes(fill = complete), col = "black", stat = "identity") +
scale_fill_brewer(palette = "Dark2") +
labs(x = "", y = "Complete Data (%)") +
coord_flip() +
theme_bw() +
theme(legend.position = "none",
legend.title = element_blank())
2*(sqrt(0.9)-sqrt(0.6))
.libPaths("C:/Users/nkapp/R")
(168.40-164.3)*6
(93.09-87.16)*16
?pdf
.libPaths("C:/Users/nkapp/R")
## Load packages
library("tidyverse")
library("ggcorrplot")
library("RColorBrewer")
library("caret")
library("glmnet")
library("PubHelper")
load("./Data/OPTIMA_Cytokine_PreprocessedData.RData")
load("./Data/Cytokine_Reference.RData")
head(cyto_ref)
table(is.na(dat$t0_bdi))
table(is.na(dat$t1_bdi))
table(is.na(dat$t2_bdi))
table(is.na(dat$t3_bdi))
table(is.na(dat$t4_bdi))
table(is.na(dat$t5_bdi))
table(is.na(dat$t6_bdi))
table(is.na(dat$t7_bdi))
.libPaths("C:/Users/nkapp/R")
x <- 1:10
y <- rnorm(10)
par(mfrow = c(2,1))
plot(x, y, main = "approx(.) and approxfun(.)")
points(approx(x, y), col = 2, pch = "*")
points(approx(x, y, method = "constant"), col = 4, pch = "*")
f <- approxfun(x, y)
curve(f(x), 0, 11, col = "green2")
points(x, y)
is.function(fc <- approxfun(x, y, method = "const")) # TRUE
curve(fc(x), 0, 10, col = "darkblue", add = TRUE)
## different extrapolation on left and right side :
plot(approxfun(x, y, rule = 2:1), 0, 11,
col = "tomato", add = TRUE, lty = 3, lwd = 2)
n <- 1:4
yn <- c(1,NA,3:4)
xout <- (1:9)/2
## Default behavior (na.rm = TRUE): NA's omitted; extrapolation gives NA
data.frame(approx(xn,yn, xout))
xn <- 1:4
data.frame(approx(xn,yn, xout))
xn
yn
xout <- (1:9)/2
xout
load("./Data/02_PsychometricData.RData")
cyto_dat = readRDS("./Data/02_data_for_analysis.rds")
load(load("./Data/OPTIMA_Cytokine_PreprocessedData.RData"))
load("./Data/OPTIMA_Cytokine_PreprocessedData.RData")
## Create empty bdi_intpol variable
dat$t7_bdi_intpol = NA
which(is.na(dat$t7_bdi))
## Obtain rows of individuals with to-be-interpolated data
rows_to_intpol = which(is.na(dat$t7_bdi))
i = rows_to_intpol
i
i = rows_to_intpol[1]
i
intpol_dat = dat[i, c("ID", paste0("t", 0:7, "_bdi"))]
intpol_dat
as.vector(intpol_dat[1, paste0("t", 0:7, "_bdi")])
class(intpol_dat[1, paste0("t", 0:7, "_bdi")])
as.vector(intpol_dat[1, paste0("t", 0:7, "_bdi")]) %>% class()
class(as.vector(intpol_dat[1, paste0("t", 0:7, "_bdi")]))
class(as.numeric(intpol_dat[1, paste0("t", 0:7, "_bdi")]))
as.numeric(intpol_dat[1, paste0("t", 0:7, "_bdi")])
approx(x = 0:7, y = as.numeric(intpol_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 8)
approx(x = 0:7, y = as.numeric(intpol_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 8, na.rm = TRUE, method = "linear", rule = 2)
library("tidyverse")
approx(x = 0:7, y = as.numeric(intpol_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 8, na.rm = TRUE, method = "linear", rule = 2) %>% data.frame
approx(x = 0:7, y = as.numeric(intpol_dat[1, paste0("t", 0:7, "_bdi")]),
na.rm = TRUE, method = "linear", rule = 2)
# Create subset of to-be-interpolated participant
id_dat = dat[i, c("ID", paste0("t", 0:7, "_bdi"))]
# Use the appox function to interpolate bdi values
intpol_dat = data.frame(approx(x = 0:7, y = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
na.rm = TRUE, method = "linear", rule = 2))
plot(intpol_dat)
plot(intpol_dat$x, intpol_dat$y)
par(c(1, 1))
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
na.rm = TRUE, method = "linear", rule = 2))
as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")])
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]), xout = 8,
na.rm = TRUE, method = "linear", rule = 2))
(1:9)/2
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]), xout = 0:7,
na.rm = TRUE, method = "linear", rule = 2))
as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")])
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 0:7,
na.rm = TRUE, method = "lconstant", rule = 2))
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 0:7,
na.rm = TRUE, method = "constant", rule = 2))
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 0:7,
na.rm = TRUE, method = "linear", rule = 2))
as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")])
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8,
na.rm = TRUE, method = "linear", rule = 2))
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8,
na.rm = TRUE, method = "linear"))
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8,
na.rm = TRUE, method = "linear"))
data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8, rule = 2,
na.rm = TRUE, method = "linear"))
rows_to_intpol
# Use the appox function to interpolate bdi values
intpol_dat = data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8, rule = 2,
na.rm = TRUE, method = "linear"))
intpol_dat
intpol_dat[8, "y"]
print(id_dat)
print(t(intpol_dat))
## Create empty bdi_intpol variable
dat$t7_bdi_intpol = NA
## Obtain rows of individuals with to-be-interpolated data
rows_to_intpol = which(is.na(dat$t7_bdi))
## Use the appox function for interpolation
for(i in rows_to_intpol)   {
# Create subset of to-be-interpolated participant
id_dat = dat[i, c("ID", paste0("t", 0:7, "_bdi"))]
# Use the appox function to interpolate bdi values
intpol_dat = data.frame(approx(x = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8, rule = 2,
na.rm = TRUE, method = "linear"))
# TEMP: Print result
print(id_dat)
print(t(intpol_dat))
# Save value for T7
dat[i, "t7_bdi_intpol"] = intpol_dat[8, "y"]
}
data.frame(approx(x = 1:8, y = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8, rule = 2,
na.rm = TRUE, method = "linear"))
i = rows_to_intpol[1]
# Create subset of to-be-interpolated participant
id_dat = dat[i, c("ID", paste0("t", 0:7, "_bdi"))]
# Use the appox function to interpolate bdi values
intpol_dat = data.frame(approx(x = 1:8, y = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8, rule = 2,
na.rm = TRUE, method = "linear"))
id_dat
intpol_dat
id_dat
sum(is.na(id_dat[1, 2:9]))
sum(!is.na(id_dat[1, 2:9]))
## Create empty bdi_intpol variable
dat$t7_bdi_intpol = NA
## Obtain rows of individuals with to-be-interpolated data
rows_to_intpol = which(is.na(dat$t7_bdi))
## Use the appox function for interpolation
for(i in rows_to_intpol)   {
# Create subset of to-be-interpolated participant
id_dat = dat[i, c("ID", paste0("t", 0:7, "_bdi"))]
# Perform interpolation only if at least 2 datapoints are available
if(sum(!is.na(id_dat[1, 2:9])) >= 2)  {
# Use the appox function to interpolate bdi values
intpol_dat = data.frame(approx(x = 1:8, y = as.numeric(id_dat[1, paste0("t", 0:7, "_bdi")]),
xout = 1:8, rule = 2,
na.rm = TRUE, method = "linear"))
# TEMP: Print result
print(id_dat)
print(t(intpol_dat))
# Save value for T7
dat[i, "t7_bdi_intpol"] = intpol_dat[8, "y"]
}
}
.libPaths("C:/Users/nkapp/R")
## Load packages
library("tidyverse")
library("ggcorrplot")
library("RColorBrewer")
library("caret")
library("glmnet")
library("PubHelper")
load("./Data/OPTIMA_Cytokine_PreprocessedData.RData")
## Create longitudinal BDI data
dat_l = with(dat,
data.frame(ID = rep(ID, 8),
time = rep(0:7, each = nrow(dat)),
bdi = c(t0_bdi, t1_bdi, t2_bdi, t3_bdi, t4_bdi, t5_bdi, t6_bdi, t7_bdi)))
head(dat_l)
dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums
dat[, paste0("t", 0:7, "_bdi")] %>% !is.na() %>% rowSums
dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSum
dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums
dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums < 7
dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums < 7 %>% which()
## Obtain IDs with minimum of two BDI values
ids_with_bdi = dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums < 7
nrow(dat[ids_with_bdi,])
nrow(dat_l[rep(ids_with_bdi, 8),])
## Create prediction model based on individuals with complete BDI data
model = lmer(bdi ~ time, data = dat_l[rep(ids_with_bdi, 8),])
library("lme4")
## Create prediction model based on individuals with complete BDI data
model = lmer(bdi ~ time, data = dat_l[rep(ids_with_bdi, 8),], REML = TRUE)
## Create prediction model based on individuals with complete BDI data
model = lmer(bdi ~ time + I(time^2) + (1 + time | ID),
data = dat_l[rep(ids_with_bdi, 8),], REML = TRUE)
summary(model)
str(model)
str(ranef(model))
## Extract person-specific slopes for time and time^2
ranef(model)
colnames(ranef(model))
class(ranef(model))
names(ranef(model))
as.data.frame(ranef(model))
class(ranef(model)$ID)
ranef(model)$ID
## Extract person-specific random slope for time
model_dat = ranef(model)$ID
## Extract person-specific random slope for time
model_ran_dat = ranef(model)$ID
model_ran_dat$ID = row.names(model_ran_dat)
head(model_ran_dat$)
head(model_ran_dat)
colnames(model_ran_dat) = c("bdi_ran_int", "bdi_ran_slope", "ID")
head(model_ran_dat)
nrow(merge(dat, model_ran_dat, by = "ID"))
nrow(merge(dat, model_ran_dat, by = "ID", all.x = TRUE))
dat = merge(dat, model_ran_dat, by = "ID", all.x = TRUE)
head(dat_l)
dat[is.na(dat$t7_bdi), "ID"]
nrow(dat_l)
dat_l[dat_l$ID %in% dat[is.na(dat$t7_bdi), "ID"], ]
nrow(dat_l[dat_l$ID %in% dat[is.na(dat$t7_bdi), "ID"], ])
## Extract predicted BDI for individuals without t7_bdi
predict_dat = dat_l[dat_l$ID %in% dat[is.na(dat$t7_bdi), "ID"], ]
head(predict_dat)
head(predict(model, predict_dat))
predict(model, predict_dat)
library("TwoSampleMR")
?harmonise_data
pvals = c(0.806, 0.031, 0.821, 0.513, 0.524, 0.783, 0.11, 0.397, 0.707, 0.283, 0.532, 0.454, 0.605, 0.036, 0.143, 0.049, 0.037, 0.497, 0.977)
pvals
p.adjust(pvals, method = "BH")
hist(pvals)
pvals = c(0.497, 0.017, 0.014, 0.005, 0.001, 0.173, 0.680, 0.314, 0.046, 0.052)
p.adjust(pvals, method = "BH")
hist(pvals)
## Fatigue
fatigue.model = 'fatigue ~ bdi_18 + cisr_5'
fatigue.model
pvals
.libPaths()
install.packages("gaston")
library("gaston")
qqplot.pvalues(pvals)
qqplot.pvalues(pvals, pch = ".", cex = 2, thinning = FALSE)
qqplot.pvalues(pvals, pch = ".", cex = 2, thinning = TRUE)
qqplot.pvalues(pvals)
?qqplot.o
?qqplot.pvalues
qqplot.pvalues(pvals, thinning = FALSE, col.abline = brewer.pal(3, "Dark2")[1], col.CB = "lightgray"))
qqplot.pvalues(pvals, thinning = FALSE, col.abline = brewer.pal(3, "Dark2")[1], col.CB = "lightgray")
qqplot.pvalues(pvals, thinning = FALSE, col.abline = brewer.pal(3, "Dark2")[2], col.CB = "lightgray")
exp(-0.033)
exp(-0.033 - 1.96 * 0.017)
exp(-0.033 + 1.96 * 0.017)
exp(-0.070 + 1.96 * 0.052)
exp(-0.070 - 1.96 * 0.052)
exp(-0.070)
exp(-0.106)
exp(-0.106 - 1.96 * 0.1)
exp(-0.106 + 1.96 * 0.1)
pvals.scz = c(0.497, 0.017, 0.014, 0.005, 0.001, 0.173, 0.680, 0.314, 0.046, 0.052)
qqplot.pvalues(pvals.scz, thinning = FALSE, col.abline = brewer.pal(3, "Dark2")[2], col.CB = "lightgray")
pvals.scz = c(0.497, 0.017, 0.014, 0.173, 0.680, 0.314, 0.046, 0.052)
qqplot.pvalues(pvals.scz, thinning = FALSE, col.abline = brewer.pal(3, "Dark2")[2], col.CB = "lightgray")
pvals.scz = c(0.497, 0.017, 0.005, 0.173, 0.680, 0.314, 0.046, 0.052)
qqplot.pvalues(pvals.scz, thinning = FALSE, col.abline = brewer.pal(3, "Dark2")[2], col.CB = "lightgray")
length(dat$ID)
exportPubHelpercsv(dat[, "ID"], file = "InflammationProject_OPTIMA-IDs.csv")
.libPaths("C:/Users/nkapp/R")
.libPaths()
## Load Packages
library("tidyverse")
library("readxl")
library("lme4")
## Load psychometric data
load("/home/nkappelmann/OPTIMA/OPTIMA_Analyses/Data/Processed/02_PsychometricData.RData")
load("./Data/02_PsychometricData.RData")
cyto_dat = readRDS("./Data/02_data_for_analysis.rds")
cyto_dat = readRDS("./Data/02_data_for_analysis_imputed.rds")
head(cyto_dat)
cyto_IDs = read_excel("./Data/01_become_optima_randomization_STD_Controls_Pheno_1219.xlsx")
head(cyto_IDs)
# Save biobank study IDs
cyto_dat$ID.bio = row.names(cyto_dat)
# Merge OPTIMA IDs
cyto_dat = merge(cyto_dat, cyto_IDs[, c("ID", "Lagerung_BC.Tube")],
by.x = "ID.bio", by.y = "Lagerung_BC.Tube", all.x = TRUE)
# Delete duplicates from merging
cyto_dat = cyto_dat[!duplicated(cyto_dat$ID),]
cyto_dat = readRDS("./Data/02_data_for_analysis_imputed.rds")
head(cyto_dat)
row.names(cyto_dat)
# Save biobank study IDs
cyto_dat$ID.bio = cyto_dat$Row.names
head(cyto_dat)
cyto_dat$ID.bio
# Merge OPTIMA IDs
cyto_dat = merge(cyto_dat, cyto_IDs[, c("ID", "Lagerung_BC.Tube")],
by.x = "ID.bio", by.y = "Lagerung_BC.Tube", all.x = TRUE)
# Delete duplicates from merging
cyto_dat = cyto_dat[!duplicated(cyto_dat$ID),]
head(cyto_dat)
# Save variable names in cytokine reference
cyto_ref = data.frame(vars = NA,
labels = colnames(cyto_dat)[10:ncol(cyto_dat)],
stringsAsFactors = FALSE)
# Change column names by excluding hyphens and slashes
colnames(cyto_dat) = gsub("/", "_", colnames(cyto_dat), fixed = TRUE)
colnames(cyto_dat) = gsub("-", ".", colnames(cyto_dat), fixed = TRUE)
colnames(cyto_dat) = gsub(" ", "_", colnames(cyto_dat), fixed = TRUE)
cyto_ref$vars = colnames(cyto_dat)[10:ncol(cyto_dat)]
cyto_ref = cyto_ref[cyto_ref$vars != "ID",]
cyto_ref
## Remove BeCOME data
cyto_dat = cyto_dat[grepl("PTP", cyto_dat$ID, fixed = TRUE),]
## Remove OPTIMA participants without cytokine data
# Note: PTP0114 is excluded as this person clicked through all of their outcome data.
dat = dat[dat$ID %in% cyto_dat$ID,]
## Remove age and sex, so these don't get duplicated
dat[, c("sex", "age")] = NULL
## Merge psychometric and cytokine data
dat = merge(dat, cyto_dat, by = "ID", all.x = TRUE)
colnames(dat)
tail(colnames(dat), 50)
## Create binarised and standardised sex variable
dat$sex_std = ifelse(dat$sex == "female", 0.5, -0.5)
## Create standardised age variable
dat$age_std = scale(dat$age)
## Create standardised t0_bdi variable
dat$t0_bdi_std = scale(dat$t0_bdi)
## Get Top 27% CRP cut-off
dat$hsCRP_inflamed = factor(ifelse(dat$CRP > quantile(dat$hsCRP, prob=1-27/100),
"Inflamed", "Non-Inflamed"),
levels = c("Non-Inflamed", "Inflamed"))
## Ward
dat$ward_type = ifelse(grepl("ST", dat$ward, fixed = TRUE), "Ward", "Day-clinic")
# Country of origin
dat$countryorigin = ifelse(dat$countryorigin == 0, "Germany", "Other")
# Ethnicity
dat$ethnicity = ifelse(dat$ethnicity == 0, "German", "Other")
# Current employment (code retired as extra category)
dat$employed = ifelse(dat$employed == 1, "Employed", "Unemployed")
dat[!is.na(dat$unemploymentreason) & dat$unemploymentreason == "retired", "employed"] = "Retired"
## Set binary variable indicating if cytokine data are complete (following imputation)
cyto_ref[, "na.sum"] = NA
for(i in cyto_ref$vars) {
cyto_ref[cyto_ref$vars == i, "na.sum"] = sum(is.na(dat[, i]))
}
cyto_ref$no.na = ifelse(cyto_ref$na.sum >= 1, 0, 1)
## Create locf variable
dat$bdi_locf = NA
## Run loop to carry forward the last observed bdi-value
for(i in 1:nrow(dat))   {
for(j in 7:0)   {
if(is.na(dat[i, "t7_bdi_locf"]) & !is.na(dat[i, paste0("t", j, "_bdi")]))     {
dat[i, "t7_bdi_locf"] = dat[i, paste0("t", j, "_bdi")]
}
}
}
## Create locf variable
dat$t7_bdi_locf = NA
dat$bdi_locf = NULL
## Run loop to carry forward the last observed bdi-value
for(i in 1:nrow(dat))   {
for(j in 7:0)   {
if(is.na(dat[i, "t7_bdi_locf"]) & !is.na(dat[i, paste0("t", j, "_bdi")]))     {
dat[i, "t7_bdi_locf"] = dat[i, paste0("t", j, "_bdi")]
}
}
}
## Create change variable by subtracting the t0 from the t7_locf score.
dat$bdi_locf_improve = dat$t0_bdi - dat$t7_bdi_locf
## Create empty bdi_locf variable
dat$t7_madrs_locf = NA
## Run loop to carry forward the last observed bdi-value
for(i in 1:nrow(dat))   {
for(j in c(7, 4, 0))   {
if(is.na(dat[i, "t7_madrs_locf"]) & !is.na(dat[i, paste0("t", j, "_madrs")]))     {
dat[i, "t7_madrs_locf"] = dat[i, paste0("t", j, "_madrs")]
}
}
}
## Create change variable by subtracting the t0 from the t7_locf score.
dat$madrs_locf_improve = dat$t0_madrs - dat$t7_madrs_locf
save(dat, file = "./Data/OPTIMA_Cytokine_PreprocessedData.RData")
save(cyto_ref, file = "./Data/Cytokine_Reference.RData")
cyto_ref
library("tidyverse")
library("ggcorrplot")
library("RColorBrewer")
library("caret")
library("glmnet")
library("PubHelper")
