theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = model), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = model), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
table(t.test.results$model)
table(recode(t.test.results$model,
'glmnet' = "Elastic net regression"))
## Recode model
t.test.results$algorithm = recode(t.test.results$model,
'glmnet' = "Elastic net regression",
'rf' = "Random forest",
'knn' = "k-nearest neighbour")
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
head(omicsplus.output$varImp)
omicsplus.output$varImp %>%
filter(type == "pred") %>%
group_by(model) %>%
summarise_all(median)
## Get long-format varImp data
varImp.stats.comb = omicsplus.output$varImp %>%
filter(type == "pred") %>%
group_by(model) %>%
summarise_at(vars(age_std:VEGF.D), median, na.rm = TRUE)
varImp.stats.comb
varImp.stats.comb = omicsplus.output$varImp %>%
filter(type == "pred") %>%
gather("glmnet", "rf", "knn", key = type, value = varImp)
varImp.stats.comb = omicsplus.output$varImp %>%
filter(type == "pred") %>%
gather(key = type, value = varImp)
varImp.stats.comb
head(omicsplus.output$varImp)
omicsplus.output$varImp %>%
filter(type == "pred") %>%
group_by(model) %>%
summarise_at(vars(age_std:VEGF.D), median, na.rm = TRUE)
## Get long-format varImp data
varImp.stats.comb = omicsplus.output$varImp %>%
filter(type == "pred") %>%
group_by(model) %>%
summarise_at(vars(age_std:VEGF.D), median, na.rm = TRUE)
t(varImp.stats.comb)
## Get long-format varImp data
varImp.stats.comb = omicsplus.output$varImp %>%
filter(type == "pred") %>%
group_by(model) %>%
summarise_at(vars(age_std:VEGF.D), median, na.rm = TRUE)
varImp.stats.comb
.libPaths("C:/Users/nkapp/R")
## Load packages
library("tidyverse")
library("ggcorrplot")
library("RColorBrewer")
library("gghalves")
library("caret")
library("glmnet")
library("PubHelper")
## Load data
load("./Data/OPTIMA_Cytokine_PreprocessedData.RData")
## Load ML model output
#load("./Results/covariates.output.RData")
load("./Results/clinical.output.RData")
load("./Results/cytokine.output.RData")
load("./Results/rna.output.RData")
load("./Results/prs.output.RData")
load("./Results/omics.output.RData")
load("./Results/omicsplus.output.RData")
## Source nested cross-validation function
source("./Scripts/functions.R")
## Fit statistics are combined
fit.stats = rbind.data.frame(clinical.output$fit,
cytokine.output$fit,
prs.output$fit,
rna.output$fit,
omics.output$fit,
omicsplus.output$fit)
## Meta-data is added
fit.stats$feature.set = rep(c("Clinical", "Cytokines", "PRS",
"Gene expression", "Multi-omics",
"Multi-omics\n+\nClinical"), each = nrow(clinical.output$fit))
## Conduct paired t-test by group
t.test.results = t.test_loop(fit.stats)
## Recode model
t.test.results$algorithm = recode(t.test.results$model,
'glmnet' = "Elastic net regression",
'rf' = "Random forest",
'knn' = "k-nearest neighbour")
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
t.test.results
t.test.results[t.test.results$feature.set == "Clinical",]
t.test_loop = function(
x, # fit statistics dataset
round_dec = 3
)  {
## Create empty output data.frame
output = expand.grid(feature.set = unique(x$feature.set),
model = unique(x$model))
output[, c("RMSE_mean", "RMSE_sd", "R2_median", "R2_25quantile", "R2_75quantile",
"RMSE_delta_mean", "RMSE_delta_sd", "RMSE_delta_median", "RMSE_delta_5quantile",
"RMSE_delta_95quantile", "RMSE", "R2", "RMSE_delta", "tval", "pval", "quant_pval")] = NA
## Loop over combinations
for(i in unique(output$feature.set))   {
for(j in unique(output$model))   {
## Subset data
x.pred = filter(x, feature.set == i & model == j & type == "pred")
x.perm = filter(x, feature.set == i & model == j & type == "perm")
## Conduct paired t-test
t.test.fit = t.test(x.pred$RMSE, x.perm$RMSE, paired = TRUE)
## Write output data
output.index = which(output$feature.set == i & output$model == j)
output[output.index, "RMSE_mean"] = mean(x.pred$RMSE)
output[output.index, "RMSE_sd"] = sd(x.pred$RMSE)
output[output.index, "R2_median"] = median(x.pred$Rsquared, na.rm = TRUE)
output[output.index, "R2_25quantile"] = quantile(x.pred$Rsquared, probs = 0.25, na.rm = TRUE)
output[output.index, "R2_75quantile"] = quantile(x.pred$Rsquared, probs = 0.75, na.rm = TRUE)
RMSE_delta = x.pred$RMSE - x.perm$RMSE
output[output.index, "RMSE_delta_mean"] = mean(RMSE_delta)
output[output.index, "RMSE_delta_sd"] = sd(RMSE_delta)
output[output.index, "RMSE_delta_median"] = median(RMSE_delta)
output[output.index, c("RMSE_delta_5quantile", "RMSE_delta_95quantile")] =
quantile(RMSE_delta, probs = c(0.05, 0.95))
output[output.index, "quant_pval"] = (1 - ecdf(RMSE_delta)(0))
output[output.index, "tval"] = t.test.fit$statistic
output[output.index, "pval"] = t.test.fit$p.value
}
}
output[, "RMSE"] = with(output, paste0(round(RMSE_mean, round_dec), " (",
round(RMSE_sd, round_dec), ")"))
output[, "R2"] = with(output, paste0(round(R2_median, round_dec), " (",
round(R2_25quantile, round_dec), "-",
round(R2_75quantile, round_dec), ")"))
output[, "RMSE_delta"] = with(output, paste0(round(RMSE_delta_mean, round_dec), " (",
round(RMSE_delta_sd, round_dec), ")"))
return(output)
}
View(t.test.results)
## Conduct paired t-test by group
t.test.results = t.test_loop(fit.stats)
## Recode model
t.test.results$algorithm = recode(t.test.results$model,
'glmnet' = "Elastic net regression",
'rf' = "Random forest",
'knn' = "k-nearest neighbour")
t.test.results[t.test.results$feature.set == "Clinical",]
t.test.results
hist(t.test.results$quant_pval)
t.test.results[t.test.results$feature.set == "Clinical",]
model = lm(t7_bdi_locf ~ t0_bdi, data = dat)
summary(model)
broom::glance(model)
broom::augment(model)
sqrt(sum(broom::augment(model)$.resid^2))
sum(sqrt(broom::augment(model)$.resid^2))
sum(sqrt(broom::augment(model)$.resid^2))/nrow(dat)
t.test.results
model = lm(t7_bdi_locf ~ t0_bdi_std, data = dat)
summary(model)
broom::glance(model)
model = lm(t7_bdi_locf ~ t0_bdi_std, data = dat[ids_for_analysis,])
## Index participants used in analysis
# Index participants with minimum of two BDI observations
ids_with_bdi = dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums < 7
# Index participants with genetic data
ids_with_geneticdata = !is.na(dat$BMI_PRS)
# Index participants with transcriptomic data
ids_with_rnadata = !is.na(dat$rna.PC1) # Present in all individuals
# Index participants with all relevant data
ids_for_analysis = ids_with_bdi & ids_with_geneticdata & ids_with_rnadata
model = lm(t7_bdi_locf ~ t0_bdi_std, data = dat[ids_for_analysis,])
summary(model)
broom::glance(model)
t.test.results
broom::glance(model)
model = lm(scale(t7_bdi_locf) ~ t0_bdi_std, data = dat[ids_for_analysis,])
broom::glance(model)
summary(model)
model = lm(sample(t7_bdi_locf) ~ t0_bdi_std, data = dat[ids_for_analysis,])
summary(model)
broom::glance(model)
t.test.results
with(dat[ids_for_analysis,], cor(t0_bdi, t0_madrs))
with(dat[ids_for_analysis,], cor(t0_bdi, t0_madrs, use = "complete.obs"))
0.4597823
^2
0.4597823^2
sqrt(0.95)
head(dat[, grepl("t0_bdi", colnames(dat))])
head(dat[, grepl("t0_bdi", colnames(dat))], 2)
table(rowSums(dat[, c("t0_bdi_", 1:21)]) == dat$t0_bdi)
rowSums(dat[, c("t0_bdi_", 1:21)]) == dat$t0_bdi
rowSums(dat[, c("t0_bdi_", 1:21)])
table(rowSums(dat[, paste0("t0_bdi_", 1:21)]) == dat$t0_bdi)
table(rowSums(abs(dat[, paste0("t0_bdi_", 1:21)])) == dat$t0_bdi)
table(rowSums(abs(dat[, paste0("t7_bdi_", 1:21)])) == dat$t7_bdi)
table(rowSums(abs(dat[, paste0("t6_bdi_", 1:21)])) == dat$t6_bdi)
head(abs(dat[, paste0("t0_bdi_", 1:21)]))
head(dat[, paste0("t0_bdi_", 1:21)])
.libPaths("C:/Users/nkapp/R")
.libPaths("C:/Users/nkapp/R")
# MPI local
load("./Data/02_PsychometricData.RData")
load("C:/Users/nkapp/Downloads/02_PsychometricData.RData")
colnames(dat)
dir = "C:/Users/nkapp/Downloads/"
write.table(data.frame(variables = colnames(dat)), row.names = FALSE, sep = ","), file = paste0(dir, "OPTIMA_Variables.csv"))
write.table(data.frame(variables = colnames(dat)), row.names = FALSE, sep = ",", file = paste0(dir, "OPTIMA_Variables.csv"))
.libPaths("C:/Users/nkapp/R")
.libPaths("C:/Users/nkapp/R")
## Load packages
library("tidyverse")
library("ggcorrplot")
library("RColorBrewer")
library("gghalves")
library("caret")
library("glmnet")
library("PubHelper")
## Load data
load("./Data/OPTIMA_Cytokine_PreprocessedData.RData")
## Load ML model output
#load("./Results/covariates.output.RData")
load("./Results/clinical.output.RData")
load("./Results/cytokine.output.RData")
load("./Results/rna.output.RData")
load("./Results/prs.output.RData")
load("./Results/omics.output.RData")
load("./Results/omicsplus.output.RData")
## Index participants used in analysis
# Index participants with minimum of two BDI observations
ids_with_bdi = dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums < 7
# Index participants with genetic data
ids_with_geneticdata = !is.na(dat$BMI_PRS)
# Index participants with transcriptomic data
ids_with_rnadata = !is.na(dat$rna.PC1) # Present in all individuals
# Index participants with all relevant data
ids_for_analysis = ids_with_bdi & ids_with_geneticdata & ids_with_rnadata
## Load cytokine reference
load("./Data/Cytokine_Reference.RData")
prs.vars = colnames(dat)[grepl("PRS", colnames(dat))]
rna.vars = colnames(dat)[grepl("rna.PC", colnames(dat))]
clin.vars = c("t0_bdi_std", "t0_madrs_std", "sex_std", "age_std", "BMI_std", "t0_diagn_by_age_std",
paste0("t0_bsi_", c("soma", "zwan", "unsi", "depr", "angs", "aggr",
"phob", "para", "psyc"), "_std"))
## Source nested cross-validation function
source("./Scripts/functions.R")
## Fit statistics are combined
fit.stats = rbind.data.frame(clinical.output$fit,
cytokine.output$fit,
prs.output$fit,
rna.output$fit,
omics.output$fit,
omicsplus.output$fit)
## Meta-data is added
fit.stats$feature.set = rep(c("Clinical", "Cytokines", "PRS",
"Gene expression", "Multi-omics",
"Multi-omics\n+\nClinical"), each = nrow(clinical.output$fit))
## Conduct paired t-test by group
t.test.results = t.test_loop(fit.stats)
## Recode model
t.test.results$algorithm = recode(t.test.results$model,
'glmnet' = "Elastic net regression",
'rf' = "Random forest",
'knn' = "k-nearest neighbour")
## Plot results
# RMSE_delta mean + sd
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_mean)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_mean - RMSE_delta_sd,
ymax = RMSE_delta_mean + RMSE_delta_sd, group = model),
stat = "identity", position = position_dodge(width = 0.3), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.3), shape = 21,
col = "black", size = 4) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
Sys.Date()
?ggsave
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformance_RMSE.png"),
device = "png", , width = 6, height = 4, dpi = 300)
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformance_RMSE.png"),
device = "png", , width = 6, height = 4, dpi = 300, bg = "transparent")
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "transparent", color = NA))
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformance_RMSE.png"),
device = "png", , width = 6, height = 4, dpi = 300, bg = "transparent")
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"),
legend.box.background = element_rect(fill = "transparent"))
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformance_RMSE.png"),
device = "png", , width = 6, height = 4, dpi = 300, bg = "transparent")
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"))
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformance_RMSE.png"),
device = "png", , width = 6, height = 4, dpi = 300, bg = "transparent")
.libPaths("C:/Users/nkapp/R")
## Load packages
library("tidyverse")
library("ggcorrplot")
library("RColorBrewer")
library("gghalves")
library("caret")
library("glmnet")
library("PubHelper")
#load("./Results/covariates.output.RData")
load("./Results/clinical.output.RData")
load("./Results/cytokine.output.RData")
load("./Results/rna.output.RData")
load("./Results/prs.output.RData")
load("./Results/omics.output.RData")
load("./Results/omicsplus.output.RData")
## Load data
load("./Data/OPTIMA_Cytokine_PreprocessedData.RData")
## Index participants used in analysis
# Index participants with minimum of two BDI observations
ids_with_bdi = dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums < 7
# Index participants with genetic data
ids_with_geneticdata = !is.na(dat$BMI_PRS)
# Index participants with transcriptomic data
ids_with_rnadata = !is.na(dat$rna.PC1) # Present in all individuals
# Index participants with all relevant data
ids_for_analysis = ids_with_bdi & ids_with_geneticdata & ids_with_rnadata
prs.vars = colnames(dat)[grepl("PRS", colnames(dat))]
rna.vars = colnames(dat)[grepl("rna.PC", colnames(dat))]
clin.vars = c("t0_bdi_std", "t0_madrs_std", "sex_std", "age_std", "BMI_std", "t0_diagn_by_age_std",
paste0("t0_bsi_", c("soma", "zwan", "unsi", "depr", "angs", "aggr",
"phob", "para", "psyc"), "_std"))
## Source nested cross-validation function
source("./Scripts/functions.R")
## Fit statistics are combined
fit.stats = rbind.data.frame(clinical.output$fit,
cytokine.output$fit,
prs.output$fit,
rna.output$fit,
omics.output$fit,
omicsplus.output$fit)
## Meta-data is added
fit.stats$feature.set = rep(c("Clinical", "Cytokines", "PRS",
"Gene expression", "Multi-omics",
"Multi-omics\n+\nClinical"), each = nrow(clinical.output$fit))
## Conduct paired t-test by group
t.test.results = t.test_loop(fit.stats)
## Recode model
t.test.results$algorithm = recode(t.test.results$model,
'glmnet' = "Elastic net regression",
'rf' = "Random forest",
'knn' = "k-nearest neighbour")
## Plot results
# RMSE_delta mean + sd
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_mean)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_mean - RMSE_delta_sd,
ymax = RMSE_delta_mean + RMSE_delta_sd, group = model),
stat = "identity", position = position_dodge(width = 0.3), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.3), shape = 21,
col = "black", size = 4) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank())
# RMSE_delta median 95% quantile
ggplot(t.test.results, aes(x = feature.set, y = RMSE_delta_median)) +
geom_hline(yintercept = 0, col = "lightgrey", size = 2) +
geom_errorbar(aes(ymin = RMSE_delta_5quantile, ymax = RMSE_delta_95quantile, group = model),
stat = "identity", position = position_dodge(width = 0.4), width = 0.2) +
geom_point(aes(fill = algorithm), position = position_dodge(width = 0.4), shape = 21,
col = "black", size = 3) +
labs(x = "", y = bquote(Delta*"RMSE: Median (95% CI)")) +
scale_fill_brewer(palette = "Dark2") +
theme_bw() +
theme(legend.position = "top",
legend.title = element_blank(),
plot.background = element_rect(fill = "transparent", color = NA),
legend.background = element_rect(fill = "transparent"))
ggsave(filename = paste0("./Plots/", Sys.Date(), "_PredPerformance_RMSE.png"),
device = "png", width = 6, height = 4, dpi = 300, bg = "transparent")
.libPaths("C:/Users/nkapp/R")
## Load Packages
library("tidyverse")
library("readxl")
# MPI local
load("./Data/02_PsychometricData.RData")
head(dat[,paste0("t", 0:7, "_bdi_som")])
## Load packages
library("tidyverse")
## Load data
load("./Data/OPTIMA_Cytokine_PreprocessedData.RData")
## Index participants used in analysis
# Index participants with minimum of two BDI observations
ids_with_bdi = dat[, paste0("t", 0:7, "_bdi")] %>% is.na() %>% rowSums < 7
# Index participants with genetic data
ids_with_geneticdata = !is.na(dat$BMI_PRS)
# Show overlap
table(ids_with_bdi, ids_with_geneticdata)
# Index participants with transcriptomic data
ids_with_rnadata = !is.na(dat$rna.PC1) # Present in all individuals
# Index participants with all relevant data
ids_for_analysis = ids_with_bdi & ids_with_geneticdata & ids_with_rnadata
## Define prs.vars
prs.vars = colnames(dat)[grepl("PRS", colnames(dat))]
## Define rna.vars
rna.vars = colnames(dat)[grepl("rna.PC", colnames(dat))]
clin.vars = c("t0_bdi", "t0_madrs", "t0_madrs", "sex", "age", "BMI", "BMI", "BMI", "t0_diagn_by_age",
paste0("t0_bsi_", c("soma", "zwan", "unsi", "depr", "angs", "aggr",
"phob", "para", "psyc")),
paste0("t0_pid_", c("negaff", "detach", "psycho", "antago", "disinh")))
str(dat)
colnames(dat)
## Set character to factor
dat = dat %>%
mutate_if(is.character, as.factor)
glimpse(dat)
data = dat
seed = 1
runningSeed = seed
?initial_split
library("tidyverse")
library("tidymodels")
sessionInfo()
